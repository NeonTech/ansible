- name: Install chrony
  notify:
    - Commit changed files on Alpine Linux
  block:
    - name: Install chrony on Alpine Linux
      when: ansible_os_family == "Alpine"
      community.general.apk:
        name: chrony
        state: installed

- name: Deploy chrony.conf
  ansible.builtin.template:
    src: roles/chrony/templates/chrony.conf.j2
    dest: "{{ chrony_conf }}"
    owner: root
    group: root
    mode: "0644" # -rw-r--r--
  notify:
    - Restart chronyd
    - Commit changed files on Alpine Linux
